(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d6d7419"],{"10f1":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mx-4"},[n("el-row",{attrs:{type:"flex",justify:"center",align:"middle"}},[n("el-col",{staticClass:"text-right",attrs:{span:8}},[t._v("\n      请输入对方的用户名：\n    ")]),n("el-col",{attrs:{span:8}},[n("el-input",{attrs:{size:"small"},model:{value:t.friend.nickname,callback:function(e){t.$set(t.friend,"nickname",e)},expression:"friend.nickname"}})],1),n("el-col",{staticClass:"ml-2",attrs:{span:8}},[n("el-button",{attrs:{size:"small",type:"primary",disabled:"free"!=t.status},on:{click:t.askACall}},[t._v(t._s("free"==t.status?"呼叫":"正在呼叫..."))]),n("el-button",{attrs:{size:"small",type:"danger",disabled:"free"==t.status},on:{click:t.stopACall}},[t._v("挂断")])],1)],1),n("el-row",{staticClass:"mt-4",attrs:{gutter:10,hidden:"free"===t.status}},[n("el-col",{staticClass:"transition-all",attrs:{span:12,offset:3,hidden:"linking"===t.status}},[n("video",{ref:"friend-video",staticClass:"m-2 friend-video border",attrs:{src:"",autoplay:"",poster:s("b8b5")}}),n("p",{staticClass:"text-center"},[t._v(t._s(t.friend.nickname))])]),n("el-col",{staticClass:"transition-all",attrs:{span:"linking"===t.status?12:6,offset:"linking"===t.status?6:0}},[n("video",{ref:"self-video",staticClass:"w-full m-2 border",attrs:{src:"",id:"self-video",autoplay:"",poster:s("b8b5"),muted:""},domProps:{muted:!0}}),n("p",{staticClass:"text-center"},[t._v("我")])])],1)],1)},a=[],i=s("5c96"),l=s("d5db"),o=s("4777"),r=s.n(o),c=s("6c23"),d=null,f=null,u={name:"page-call",data:function(){return{friend:{nickname:""},status:"free"}},created:function(){window.addEventListener("unload",this.stopACall)},mounted:function(){console.log(this)},beforeDestroy:function(){this.stopACall(),window.removeEventListener("unload",this.stopACall)},methods:{askACall:function(){var t=this.friend.nickname;t&&t.trim()?(this.stopACall(),d=new l["a"](this.$refs["self-video"]),d.on("error",this.onCallerror),d.start(t.trim(),!1),this.status="linking",this.bindEvents()):this.$message.warning("请输入对方用户名")},stopACall:function(){this.offEvents(),d&&d.stop(),f&&f.stop(),this.status="free"},bindEvents:function(){var t=Object(c["a"])();t.once("callaccepted",this.onCallaccepted),t.once("callrejected",this.onCallrejected),t.on("callerror",this.onCallerror)},offEvents:function(){var t=Object(c["a"])();t.off("callaccepted",this.onCallaccepted),t.off("callrejected",this.onCallrejected),t.off("callerror",this.onCallerror)},onCallrejected:function(t){var e=t.to;this.stopACall(),this.status="free",i["Notification"].warning({title:"呼叫已被".concat(e.nickname,"拒绝")})},onCallaccepted:function(t){var e=this,s=t.to,n=t.linkId;console.log("呼叫已被".concat(s.nickname,"接听")),this.status="calling",i["Notification"].success({title:"呼叫已被".concat(s.nickname,"接听"),message:"正在建立连接..."}),f=new r.a(this.$refs["friend-video"],n),f.on("presentorgone",function(t){e.stopACall()}),f.start()},onCallerror:function(t){var e=t.message;this.stopACall(),i["Notification"].error({title:e}),this.status="free"}}},p=u,h=(s("8b98"),s("2877")),m=Object(h["a"])(p,n,a,!1,null,null,null);e["default"]=m.exports},4777:function(t,e){},"8b98":function(t,e,s){"use strict";var n=s("e5a6"),a=s.n(n);a.a},e5a6:function(t,e,s){}}]);
//# sourceMappingURL=chunk-1d6d7419.34de713b.js.map