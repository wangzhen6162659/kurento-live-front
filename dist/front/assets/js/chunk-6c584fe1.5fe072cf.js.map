{"version":3,"sources":["webpack:///./src/views/call/accept.vue?aebe","webpack:///src/views/call/accept.vue","webpack:///./src/views/call/accept.vue?54d1","webpack:///./src/views/call/accept.vue","webpack:///./src/views/call/accept.vue?1b8d"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","type","span","_v","size","on","click","$event","$router","back","gutter","directives","name","rawName","value","expression","offset","element-loading-text","element-loading-spinner","ref","src","autoplay","poster","__webpack_require__","_s","inviter","nickname","muted","domProps","staticRenderFns","acceptvue_type_script_lang_js_presentor","acceptvue_type_script_lang_js_viewer","acceptvue_type_script_lang_js_","data","selfLoading","friendLoading","watch","$route.query","immediate","handler","originEncoded","decodeURIComponent","$route","query","JSON","parse","linkId","acceptCall","created","window","addEventListener","stopCall","mounted","beforeDestroy","removeEventListener","methods","_this","presentor","$refs","socket","emit","from","start","viewer_default","a","_","stop","call_acceptvue_type_script_lang_js_","component","Object","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_accept_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_accept_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"assets/js/chunk-6c584fe1.5fe072cf.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page-accept mx-8\"},[_c('el-row',{attrs:{\"type\":\"flex my-4\"}},[_c('el-col',{staticClass:\"flex items-center\",attrs:{\"span\":20}},[_c('h1',{staticClass:\"font-bold text-2xl\"},[_vm._v(\"正在通话\")])]),_c('el-col',{attrs:{\"span\":4}},[_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.$router.back()}}},[_vm._v(\"挂断\")])],1)],1),_c('el-row',{staticClass:\"mx-4\",attrs:{\"gutter\":20}},[_c('el-col',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.friendLoading),expression:\"friendLoading\"}],staticClass:\"transition-all\",attrs:{\"span\":12,\"offset\":3,\"element-loading-text\":\"正在连接...\",\"element-loading-spinner\":\"el-icon-loading\"}},[_c('video',{ref:\"friend-video\",staticClass:\"w-full\",attrs:{\"src\":\"\",\"autoplay\":\"\",\"poster\":require(\"@/assets/webrtc.png\")}}),_c('p',{staticClass:\"text-center\"},[_vm._v(_vm._s(_vm.inviter.nickname))])]),_c('el-col',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.selfLoading),expression:\"selfLoading\"}],staticClass:\"transition-all\",attrs:{\"span\":6,\"element-loading-text\":\"正在连接...\",\"element-loading-spinner\":\"el-icon-loading\"}},[_c('video',{ref:\"self-video\",staticClass:\"w-full\",attrs:{\"src\":\"\",\"autoplay\":\"\",\"poster\":require(\"@/assets/webrtc.png\"),\"muted\":\"\"},domProps:{\"muted\":true}}),_c('p',{staticClass:\"text-center\"},[_vm._v(\"我\")])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"page-accept mx-8\">\n    <el-row type=\"flex my-4\">\n      <el-col :span=\"20\" class=\"flex items-center\">\n        <h1 class=\"font-bold text-2xl\">正在通话</h1>\n      </el-col>\n      <el-col :span=\"4\">\n        <el-button type=\"danger\" size=\"small\" @click=\"$router.back()\">挂断</el-button>\n      </el-col>\n    </el-row>\n    <el-row class=\"mx-4\" :gutter=\"20\">\n      <el-col :span=\"12\" v-loading=\"friendLoading\" class=\"transition-all\" :offset=\"3\"\n       element-loading-text=\"正在连接...\" element-loading-spinner=\"el-icon-loading\">\n        <video src=\"\" autoplay class=\"w-full\" ref=\"friend-video\"\n          poster=\"@/assets/webrtc.png\"\n        ></video>\n        <p class=\"text-center\">{{inviter.nickname}}</p>\n      </el-col>\n      <el-col :span=\"6\" v-loading=\"selfLoading\" class=\"transition-all\"\n        element-loading-text=\"正在连接...\" element-loading-spinner=\"el-icon-loading\">\n        <video src=\"\" autoplay class=\"w-full\" ref=\"self-video\" poster=\"@/assets/webrtc.png\" muted></video>\n        <p class=\"text-center\">我</p>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport Presentor from '../presentor/presentor'\nimport Viewer from '../live/viewer'\n\nlet presentor = null\nlet viewer = null\nexport default {\n  name: 'page-accept',\n  data () {\n    return {\n      inviter: {},\n      selfLoading: false,\n      friendLoading: false\n    }\n  },\n  watch: {\n    '$route.query': {\n      immediate: false,\n      handler () {\n        const originEncoded = decodeURIComponent(this.$route.query.inviter || '')\n        const inviter = originEncoded && JSON.parse(originEncoded)\n        const linkId = decodeURIComponent(this.$route.query.linkId || '')\n        inviter && linkId && this.acceptCall(inviter, linkId)\n      }\n    }\n  },\n  created () {\n    window.addEventListener('unload', this.stopCall)\n    this.stopCall()\n  },\n  mounted () {\n    const originEncoded = decodeURIComponent(this.$route.query.inviter || '')\n    const inviter = originEncoded && JSON.parse(originEncoded)\n    const linkId = decodeURIComponent(this.$route.query.linkId || '')\n    inviter && linkId && this.acceptCall(inviter, linkId)\n  },\n  beforeDestroy () {\n    this.stopCall()\n    window.removeEventListener('unload', this.stopCall)\n  },\n  methods: {\n    acceptCall (inviter, linkId) {\n      this.inviter = inviter\n      this.selfLoading = true\n      this.friendLoading = true\n      presentor = new Presentor(this.$refs['self-video'])\n      presentor.on('start', () => {\n        this.selfLoading = false\n        presentor.socket.emit('acceptcall', { from: inviter })\n      })\n      presentor.start(null, false)\n\n      viewer = new Viewer(this.$refs['friend-video'], linkId)\n      viewer.on('start', _ => {\n        this.friendLoading = false\n      })\n      viewer.on('presentorgone', _ => {\n        // 对方挂断\n        this.stopCall()\n        this.$router.back()\n      })\n      viewer.start()\n    },\n    stopCall () {\n      presentor && presentor.stop()\n      viewer && viewer.stop()\n    }\n  }\n}\n</script>\n\n<style>\n.transition-all {\n  transition: all .4s;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./accept.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./accept.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./accept.vue?vue&type=template&id=3cdc6d34&\"\nimport script from \"./accept.vue?vue&type=script&lang=js&\"\nexport * from \"./accept.vue?vue&type=script&lang=js&\"\nimport style0 from \"./accept.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./accept.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./accept.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}